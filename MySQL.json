Сформулируйте SQL запрос для создания таблицы book, занесите  его в окно кода (расположено ниже)  и отправьте на проверку (кнопка Отправить). 

create table book
 (book_id INT primary key auto_increment,
 title varchar(50) not null,
 author varchar(30) not null,
 price decimal(8,2) not null,
 amount INT(20) not null);

 Занесите новую строку в таблицу book (текстовые значения (тип VARCHAR) заключать либо в двойные, либо в одинарные кавычки):

 insert into book values (1,"Мастер и Маргарита","Булгаков М.А.",670.99,3);

 Занесите три последние записи в таблицуbook,  первая запись уже добавлена на предыдущем шаге:

 insert into book values (2,"Белая гвардия","Булгаков М.А.",540.50,5);
insert into book values (3,"Идиот","Достоевский Ф.М.",460.00,10);
insert into book values (4,"Братья Карамазовы","Достоевский Ф.М.",799.01,2);
select*from book;


Вывести информацию о всех книгах, хранящихся на складе.

Для этого:

Напишите SQL запрос в окне кода;
Отправьте на проверку (кнопка  Отправить);
Если запрос работает неверно, исправьте его и снова отправьте на проверку.
Важно! В окне кода можно использовать комментарии для сохранения разных вариантов запросов или пояснений. Комментарии заключаются в /* и */

select*from book;


Выбрать авторов, название книг и их цену из таблицы book.

select author,title,price from book;

Выбрать названия книг и авторов из таблицы book, для поля title задать имя(псевдоним) Название, для поля author –  Автор.

select title as Название, author as Автор from book;


При анализе продаж книг выяснилось, что наибольшей популярностью пользуются книги Михаила Булгакова, на втором месте книги Сергея Есенина. Исходя из этого решили поднять цену книг Булгакова на 10%, а цену книг Есенина - на 5%. Написать запрос, куда включить автора, название книги и новую цену, последний столбец назвать new_price. Значение округлить до двух знаков после запятой.

select author,title,
ROUND(if(author="Булгаков М.А.",price*1.1, if(author="Есенин С.А.",price*1.05,price)), 2) as new_price
from book;


Вывести название, автора,  цену  и количество всех книг, цена которых меньше 500 или больше 600, а стоимость всех экземпляров этих книг больше или равна 5000.

select title,author,price,amount from book
where (price>500 OR price<600) AND price*amount>=5000;

Вывести название и авторов тех книг, цены которых принадлежат интервалу от 540.50 до 800 (включая границы),  а количество или 2, или 3, или 5, или 7 .

select title,author
from book
where price BETWEEN 540.50 AND 800 AND amount IN (2,3,5,7);


Вывести  автора и название  книг, количество которых принадлежит интервалу от 2 до 14 (включая границы). Информацию  отсортировать сначала по авторам (в обратном алфавитном порядке), а затем по названиям книг (по алфавиту).

select author,title
from book
where amount >=2 and amount <=14
order by author desc,title asc;


Вывести название и автора тех книг, название которых состоит из двух и более слов, а инициалы автора содержат букву «С». Считать, что в названии слова отделяются друг от друга пробелами и не содержат знаков препинания, между фамилией автора и инициалами обязателен пробел, инициалы записываются без пробела в формате: буква, точка, буква, точка. Информацию отсортировать по названию книги в алфавитном порядке.

select title,author
from book
where title like "%_ _%"
and (author LIKE "_% С._%"
or author LIKE "_%С.%")
order by title;

Отобрать различные (уникальные) элементы столбца amount таблицы book.

select amount
from book
group by amount;

Посчитать, количество различных книг и количество экземпляров книг каждого автора , хранящихся на складе.  Столбцы назвать Автор, Различных_книг и Количество_экземпляров соответственно.

SELECT author as "Автор", count(author) as "Различных_книг",
sum(amount) as "Количество_экземпляров"
FROM book
GROUP BY author;

Вывести фамилию и инициалы автора, минимальную, максимальную и среднюю цену книг каждого автора . Вычисляемые столбцы назвать Минимальная_цена, Максимальная_цена и Средняя_цена соответственно.

select author, MIN(price) as "Минимальная_цена", MAX(price) as "Максимальная_цена", AVG(price) as "Средняя_цена"
from book
group by author;

Для каждого автора вычислить суммарную стоимость книг S (имя столбца Стоимость), а также вычислить налог на добавленную стоимость  для полученных сумм (имя столбца НДС ) , который включен в стоимость и составляет k = 18%,  а также стоимость книг  (Стоимость_без_НДС) без него. Значения округлить до двух знаков после запятой. В запросе для расчета НДС(tax)  и Стоимости без НДС(S_without_tax) использовать следующие формулы:

select author,
SUM(price*amount)  as "Стоимость",
ROUND((SUM(price*amount)*0.18/ 1.18), 2) as "НДС",
ROUND((SUM(price*amount)/ 1.18), 2) as"Стоимость_без_НДС"
from book
group by author;


Посчитать стоимость всех экземпляров каждого автора без учета книг «Идиот» и «Белая гвардия». В результат включить только тех авторов, у которых суммарная стоимость книг (без учета книг «Идиот» и «Белая гвардия») более 5000 руб. Вычисляемый столбец назвать Стоимость. Результат отсортировать по убыванию стоимости.


select author,
sum(price*amount) as 'Стоимость'
from book
where title <> 'Идиот'or'Белая гвардия'
group by author
having sum(price*amount)>5000
order by author desc;
